<!DOCTYPE html><html><head>
      <title>SAD - U2.2. Criptografía Simétrica</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,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") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="sad---u22-criptografía-simétrica">SAD - U2.2. Criptografía Simétrica </h1>
<p><a href="./U2_2_Criptograf%C3%ADaSim%C3%A9trica.pdf">Descargar estos apuntes</a></p>
<h2 id="índice">Índice </h2>

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#1-criptografía-simétrica" class="md-toc-link"><ol>
<li>Criptografía Simétrica</li>
</ol>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#11-criptografía-simétrica-de-flujo" class="md-toc-link">
            <p>1.1. Criptografía simétrica de flujo</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#12-criptografía-simétrica-de-bloque" class="md-toc-link">
            <p>1.2. Criptografía simétrica de bloque</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ecb-electronic-code-book" class="md-toc-link">
            <p>ECB (Electronic Code Book)</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#cbc-cipher-block-chaining" class="md-toc-link">
            <p>CBC (Cipher Block Chaining)</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#cfb-cipher-feedback" class="md-toc-link">
            <p>CFB (Cipher Feedback)</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#2-criptografía-simétrica-con-openssl" class="md-toc-link"><ol start="2">
<li>Criptografía simétrica con OpenSSL</li>
</ol>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#21-instalación-de-openssl" class="md-toc-link">
            <p>2.1. Instalación de OpenSSL</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#22-uso-de-openssl-para-cifrado-simétrico" class="md-toc-link"><p>2.2. Uso de OpenSSL para cifrado simétrico</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#221-cifrado-simétrico-de-flujo" class="md-toc-link">
            <p>2.2.1. Cifrado simétrico de flujo</p>

          </a></div>
        </div>
      </details>
    
</div>
<div style="\&quot;page-break-after:always;\&quot;"></div>
<h2 id="1-criptografía-simétrica">1. Criptografía Simétrica </h2>
<div style="display: flex; justify-content: center; align-items: center; margin-top: 15px; margin-bottom: 15px">
    <img height="400" src="https://securitcrs.wordpress.com/wp-content/uploads/2015/01/clave-simc3a9trica1.jpg">
</div>
<p>Los algoritmos de <strong>cifrado simétrico, o clave privada</strong>, utilizan la misma clave para encriptar y desencriptar datos. Los algoritmos implementan el conjunto de las operaciones matemáticas necesarias para encriptar un texto plano, o desencriptar un texto cifrado, utilizando una clave simétrica.</p>
<p>Si bien las implementaciones de software piden una contraseña de cifrado, no se utiliza dicha contraseña directamente. Generan una clave de cifrado de determinada cantidad de bits utilizando de base la contraseña provista, y una función de derivación de clave.</p>
<p>Así, si <code>Ana</code> quiere encriptar un dato:</p>
<ol>
<li>Introduce su contraseña.</li>
<li>Se crea una clave de cifrado derivada de dicha contraseña.</li>
<li>Se usa dicha clave para encriptar los datos.</li>
<li><code>Ana</code> envía los datos cifrados a Bob.</li>
<li><code>Bob</code> toma el dato cifrado, introduce la misma contraseña.</li>
<li>La función de derivación de clave genere la misma clave que <code>Ana</code>.</li>
<li>Se utiliza esta clave en el algoritmo para desencriptar el dato.</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Ahora bien, las primitivas de encriptación y de desencriptación pueden o no ser las mismas.</p>
<p>Esto significa que el algoritmo de encriptación puede ser diferente al de desencriptación, pero ambos deben ser capaces de trabajar con la misma clave.</p>
</div>
<table>
<thead>
<tr>
<th>Ventajas</th>
<th>Inconvenientes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Son rápidos y eficientes.</td>
<td>Exigen una clave diferente por cada pareja de interlocutores (el espacio de claves se incrementa enormemente conforme aumentan los interlocutores).</td>
</tr>
<tr>
<td>Resultan apropiados para el cifrado de grandes volúmenes de datos.</td>
<td>Requiere un control estricto sobre el intercambio seguro de la clave entre el emisor y el receptor.</td>
</tr>
<tr>
<td></td>
<td>Son vulnerables a ataques por fuerza bruta, por lo que la fortaleza de la clave es fundamental.</td>
</tr>
</tbody>
</table>
<h3 id="11-criptografía-simétrica-de-flujo">1.1. Criptografía simétrica de flujo </h3>
<p>Supongamos que queremos cifrar la palabra <code>balmis</code> utilizando la clave <code>0123</code>. Para ello necesitamos un algoritmo de cifrado. En este caso, supongamos que el algoritmo de cifrado, es decir, el conjunto de tareas que toma un texto plano de entrada, y una clave simétrica, y devuelve un texto cifrado, es la realización de la operación XOR entre los bits del texto plano y de la clave.</p>
<p>En nuestro caso, si traducimos los caracteres ASCII de la palabra <code>balmis</code> a su representación hexadecimal para facilitar la operación de bits, obtenemos lo siguiente:</p>
<pre data-role="codeBlock" data-info="plaintext" class="language-plaintext plaintext"><code>ASCII:  b   a   l   m   i   s
Hexa:   62  61  6C  6D  69  73
</code></pre><p>Si hacemos lo mismo con la clave:</p>
<pre data-role="codeBlock" data-info="plaintext" class="language-plaintext plaintext"><code>ASCII:  0   1   2   3
Hexa:   30  31  32  33
</code></pre><p>Ahora, procedemos a hacer el XOR entre cada valor hexadecimal.<br>
Como la clave es más corta que la cadena, vamos a repetirla hasta completar el texto plano:</p>
<pre data-role="codeBlock" data-info="plaintext" class="language-plaintext plaintext"><code>Texto plano:  balmis
Hexa balmis:        62  61  6C  6D  69  73
Hexa key "0123":    30  31  32  33  30  31
Resultado XOR:      52  50  5E  5E  59  42
ASCII cifrado:       R   P   ^   ^   Y   B
</code></pre><p>En este caso, la cadena cifrada que le envía <code>Ana</code> a <code>Bob</code> sería <code>RP^^YB</code>.</p>
<p>Ahora, veamos cómo descifrar el texto y obtener el mensaje original.</p>
<p>En este caso particular, el algoritmo de cifrado, XOR, es simétrica (no confundir con el concepto de criptografía simétrica en general), por lo que utilizaremos el mismo algoritmo para descifrar el contenido. Hagamos la prueba:</p>
<pre data-role="codeBlock" data-info="plaintext" class="language-plaintext plaintext"><code>Texto cifrado:      R   P   ^   ^   Y   B
Hexa cifrado:       52  50  5E  5E  59  42
Hexa key "0123":    30  31  32  33  30  31
Resultado XOR:      62  61  6C  6D  69  73
ASCII descifrado:   b   a   l   m   i   s
</code></pre><p>A este tipo de algoritmos, que cifran pequeñas porciones de dato, como ser bytes, o words, se los denomina <strong>cifradores de flujo o de stream</strong>.</p>
<p>Entre los <code>algoritmos de cifrado simétrico de stream</code> más conocidos se encuentran <strong>RC4, y Salsa20 y Chacha</strong>. En general se trata de algoritmos más eficientes que los de bloque. Igualmente, por su forma de trabajo, suelen ser más propensos a ataques, por ejemplo, RC4 hoy se considera obsoleto.</p>
<div class="admonition info">
<p class="admonition-title">Función simétrica</p>
<p>Hemos utilizado la <strong>misma clave para cifrar</strong> el texto plano <strong>y para descifrar</strong> el texto cifrado.</p>
<p>Además, las primitivas de encriptación y desencriptación de este algoritmo son la misma: la operación XOR.<br>
XOR es una función simétrica <em>(no confundir con el concepto de criptografía simétrica en general)</em>, por lo que permite utilizar el mismo algoritmo para las dos operaciones.</p>
</div>
<h3 id="12-criptografía-simétrica-de-bloque">1.2. Criptografía simétrica de bloque </h3>
<p>Existen otro tipo de cifradores simétricos que, en lugar de encriptar un flujo continuo de bits, dividen los datos en bloques de igual tamaño y los encriptan obteniendo bloques cifrados que luego se utilizarán para componer el texto cifrado.</p>
<p>En este caso el texto cifrado se genera encriptando bloques de tamaño fijo del texto plano. Los tamaños comunes de bloque son 128b, 256b, 384b, y 512b.</p>
<p>Estos cifradores generan, a partir de una contraseña y una función de derivación de clave, una clave del tamaño necesario para encriptar un bloque de datos. El tamaño de la clave, así, depende del tamaño del bloque seleccionado.</p>
<p><img src="https://juncotic.com/wp-content/uploads/2022/09/bloques-2.jpg" alt="Criptosistema"></p>
<blockquote>
<p>Donde cada bloque de texto plano (M1, M2, …) genera texto cifrado (C1, C2, …) mediante el uso de un algoritmo de encriptación (E) y una clave simétrica. En la imagen de la derecha podemos ver el proceso con el algoritmo de desencriptación (D).</p>
</blockquote>
<p>Los <code>algoritmos de cifrado simétrico de bloque</code> más conocidos son <strong>AES, DES, 3DES, Twofish, y Blowfish</strong>.</p>
<ul>
<li>AES (Advanced Encryption Standard) es un estándar de criptografía industrial. Ofrece tres tipos de longitudes de claves: 128, 192 y 256 bits.</li>
<li>Camellia Desarrollado en Japón, crea claves de 128, 192 y 256 bits. Es utilizado por TLS.</li>
<li>Triple DES Diseñado para agrandar el largo de la clave sin necesidad de cambiar el algoritmo Data Encryption Standard (DES), tarjetas de crédito y otros medios de pago electrónicos tienen como estándar el algoritmo Triple DES pero está desapareciendo lentamente, siendo reemplazado por AES que es hasta 6 veces más rápido.</li>
<li>Twofish El tamaño de bloque en Twofish es de 128 bits y el tamaño de clave puede llegar hasta 256 bits. Es rápido, flexible y eficiente y es utilizado en las herramientas de gestión de contraseñas y sistemas de pago seguros.</li>
</ul>
<p>Estos cifradores suelen <strong>encadenar</strong> las operaciones de cifrado/descifrado de bloques de tal forma que se dificulte el trabajo a un atacante. Esta manera de encadenamiento se denomina <strong>modo de operación</strong> del algoritmo.</p>
<p>Cada uno de estos modos poseen sus ventajas y desventajas, algunos son paralelizables mientras que otros no, algunos carecen de difusión (propiedad criptográfica) y otros no, etc.</p>
<h3 id="ecb-electronic-code-book">ECB (Electronic Code Book) </h3>
<p>En este modo, cada bloque de texto plano se encripta de forma independiente. Es decir, el primer bloque de texto plano se encripta con la clave y se obtiene un bloque de texto cifrado, el segundo bloque de texto plano se encripta con la misma clave y se obtiene un segundo bloque de texto cifrado, y así sucesivamente.</p>
<p>Este modo es muy sencillo de implementar, pero presenta un problema: si dos bloques de texto plano son iguales, los bloques de texto cifrado resultantes también lo serán. Esto puede ser aprovechado por un atacante para obtener información sobre el texto plano.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/ECB_encryption.svg/800px-ECB_encryption.svg.png" alt="ECB"></p>
<span style="align: center;">
<table align="center">
<tbody><tr>
<td>
<div align="center">
    <img height="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Tux.svg/196px-Tux.svg.png">
</div>
</td>
<td>
<div align="center">
    <img height="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Tux_encrypted_ecb.png/196px-Tux_encrypted_ecb.png">
</div>
</td>
<td>
<div align="center">
    <img height="" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/Tux_encrypted_ctr.png/196px-Tux_encrypted_ctr.png">
</div>
</td>
</tr>
</tbody></table>
</span>
<div class="admonition note">
<p class="admonition-title">Difusión</p>
<p>Se dice que este método carece de <strong>difusión</strong>. La difusión es una propiedad de los algoritmos criptográficos que implica modificar la mayor cantidad posible de bits del texto cifrado al cambiar un bit del texto plano.</p>
</div>
<h3 id="cbc-cipher-block-chaining">CBC (Cipher Block Chaining) </h3>
<p>En este modo, cada bloque de texto plano se encripta con el bloque de texto cifrado anterior. Es decir, el primer bloque de texto plano se encripta con la clave y se obtiene un bloque de texto cifrado, el segundo bloque de texto plano se encripta con la clave y se obtiene un segundo bloque de texto cifrado, pero antes de encriptar este segundo bloque, se realiza una operación XOR entre el segundo bloque de texto plano y el primer bloque de texto cifrado.</p>
<p>Este modo es más seguro que el modo ECB, ya que no se pueden obtener patrones en el texto cifrado. Además, es más difícil de paralelizar, lo que dificulta el trabajo de un atacante.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/CBC_encryption.svg/800px-CBC_encryption.svg.png" alt="CBC"></p>
<div class="admonition note">
<p class="admonition-title">Difusión vs Paralelización</p>
<p>La ventaja de este modo (y de todos los demás) es que genera diferentes bloques cifrados para dos bloques de texto plano iguales, lo que incrementa la difusión del algoritmo.</p>
<p>Como desventaja, la encriptación en este modo no es paralelizable, por lo que el procesamiento es secuencial.</p>
</div>
<h3 id="cfb-cipher-feedback">CFB (Cipher Feedback) </h3>
<p>En este modo, el cifrador se utiliza como un generador de secuencia de bits. El cifrador se inicializa con la clave y se encripta un bloque de texto plano. El resultado se encripta de nuevo con la clave y se obtiene un bloque de texto cifrado. Este bloque de texto cifrado se utiliza para encriptar el siguiente bloque de texto plano.</p>
<p>Este modo es muy similar al modo CBC, pero en lugar de encriptar el bloque de texto plano, se encripta el bloque de texto cifrado anterior.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/CFB_encryption.svg/800px-CFB_encryption.svg.png" alt="CFB"></p>
<div class="admonition note">
<p class="admonition-title">Otros modos</p>
<p>Existen otros modos de operación, como <strong>OFB (Output Feedback)</strong>, <strong>CTR (Counter)</strong>, <strong>GCM (Galois/Counter Mode)</strong>, <strong>XTS (XEX-based tweaked-codebook mode with ciphertext stealing)</strong>, entre otros.</p>
<p>Cada uno de estos modos posee sus ventajas y desventajas, algunos son paralelizables mientras que otros no, algunos carecen de difusión (propiedad criptográfica) y otros no, etc.</p>
</div>
<p>Podemos ver un extracto de los modos de operación de los cifradores de openssl en la siguiente imagen:</p>
<p><img src="recursos/ssl_ciphers.png" alt="Modos de operación"></p>
<div class="admonition question">
<p class="admonition-title">Cifradores simétricos</p>
<p><strong>Actividad U2.1</strong>: Calcula cuantas claves necesitan intercambiar un grupo de cuatro personas que se quieran enviar correos electrónicos cifrados entre ellas, tanto para el caso de utilizar criptografía simétrica como asimétrica. ¿Y si el grupo lo conforman seis personas? ¿Y si son mil?</p>
<p><strong>Actividad U2.2</strong>: Investiga sobre los cifradores simétricos más utilizados en la actualidad. ¿Qué algoritmos son los más seguros? ¿Qué algoritmos son los más rápidos? ¿Qué algoritmos son los más eficientes? ¿Qué tamaño de clave permite cada uno de ellos? ¿Cuál es su principal uso?</p>
<p>Crea una tabla comparativa con los resultados obtenidos.</p>
</div>
<h2 id="2-criptografía-simétrica-con-openssl">2. Criptografía simétrica con OpenSSL </h2>
<p>OpenSSL es una biblioteca de software que implementa protocolos y algoritmos de cifrado seguros. Es ampliamente utilizada en aplicaciones de software para garantizar la seguridad de la información.</p>
<h3 id="21-instalación-de-openssl">2.1. Instalación de OpenSSL </h3>
<h4 id="211-instalación-en-windows">2.1.1. Instalación en Windows </h4>
<p>WINDOWS<br>
Para la instalación de OpenSSL en Windows, se debe de realizar correctamente los pasos que se describen a continuación. Además, al instalar OpenSSL puede que el sistema requiera usar Microsoft Visual C++ [<a href="https://support.microsoft.com/es-es/help/2977003/the-latest-supported-visual-c-downloads">Descarga</a>].</p>
<ol>
<li>
<p>Descargar la última versión de OpenSSL desde la página de <a href="https://slproweb.com/products/Win32OpenSSL.html">slproweb</a>.</p>
</li>
<li>
<p>Ejecutar el archivo .exe descargado y mantener la configuración que aparece por defecto excepto cuando pida copiar las DLL de OpenSSL que se seleccionará la opción: <code>The OpenSSL binaries (/bin) directory</code>.</p>
</li>
<li>
<p>Ejecutar la consola <code>sysdm.cpl</code> y en la penstaña de <em>Opciones Avanzadas</em></p>
<ol>
<li>Añadir <code>C:\Program Files\OpenSSL-Win64</code> y <code>C:\Program Files\OpenSSL-Win64\bin</code> al PATH del sistema.</li>
<li>Crear una nueva variable de usuario llamada <code>OPENSSL_CONF</code> con el valor <code>C:\Program Files\OpenSSL-Win64\bin\cnf</code>.</li>
<li>Abrir una nueva consola y ejecutar <code>openssl version</code> para comprobar que la instalación ha sido correcta.</li>
</ol>
</li>
</ol>
<h4 id="212-instalación-en-gnulinux">2.1.2. Instalación en GNU/Linux </h4>
<p>En la mayoría de distribuciones GNU/Linux, las librerías y utilidades de OpenSSL ya vienen preinstaladas.</p>
<p>En cualquier caso, para instalar OpenSSL en sistemas basados en Debian, como Ubuntu, realizamos las siguientes acciones:</p>
<ol>
<li>
<p>Averiguar cuál es y descargar la última versión de OpenSSL:<br>
Para averiguar cuál es la última versión de OpenSSL hay que acceder a <a href="https://www.openssl.org/source">https://www.openssl.org/source</a> y apuntar el nombre del fichero en la primera línea de la tabla de descargas</p>
<p>A fecha de la última actualización de este documento la versión disponible es la <strong>openssl-3.4.0.tar.gz</strong> que es la que usaremos en este ejemplo.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Entorno y librerías</p>
<p>Para compilar OpenSSL necesitamos tener instalado el paquete <code>build-essential</code> y las librerías de desarrollo de <code>zlib</code>.<br>
Si no están instaladas (falla el comando config del paso 3), podemos hacerlo con el siguiente comando:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> upgrade
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> build-essential checkinstall zlib1g-dev <span class="token parameter variable">-y</span>
</code></pre></div>
<ol start="2">
<li>
<p>Descargar, descomprimir e instalar la última versión de OpenSSL:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token builtin class-name">cd</span> /tmp
<span class="token function">wget</span> https://www.openssl.org/source/openssl-3.4.0.tar.gz
<span class="token function">tar</span> xvf openssl-3.4.0.tar.gz
</code></pre></li>
<li>
<p>Compilar, probar e instalar OpenSSL:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token builtin class-name">cd</span> openssl-3.4.0
<span class="token function">sudo</span> ./config <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/ssl <span class="token parameter variable">--openssldir</span><span class="token operator">=</span>/usr/local/ssl shared zlib
<span class="token function">sudo</span> <span class="token function">make</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token builtin class-name">test</span>
<span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre></li>
<li>
<p>Configurar las librerías de OpenSSL:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">"echo /usr/local/ssl/lib &gt;&gt; /etc/ld.so.conf.d/openssl-3.4.0.conf"</span>
<span class="token function">sudo</span> ldconfig <span class="token parameter variable">-v</span>
</code></pre></li>
<li>
<p>Configurar el PATH añadiendo <code>/usr/local/ssl/bin</code> al principio de la variable de entorno PATH, esto hará que el comando openssl se busque antes en el directorio de nuestra instalación que en el ya existente (típicamente `/usr/bin):</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">"PATH=/usr/local/ssl:\<span class="token environment constant">$PATH</span>"</span> <span class="token operator">&gt;&gt;</span> /etc/profile
</code></pre></li>
<li>
<p>Salir de la sesión y volver a entrar para que los cambios en el PATH surtan efecto. Una vez hecho esto, comprobamos que la instalación ha sido correcta:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>openssl version
</code></pre></li>
</ol>
<h2 id="22-uso-de-openssl-para-cifrado-simétrico">2.2. Uso de OpenSSL para cifrado simétrico </h2>
<p>Para proceder a cifrar o descifrar mensajes se hará uso del comando <code>enc</code>. Se utiliza tanto para cifrados de bloque como de flujo, haciendo uso de <strong>claves basadas en contraseñas o claves proporcionadas explícitamente</strong> (clave y vector de inicialización, en su caso).</p>
<p>El subcomando <code>enc -list</code> lista los algoritmos simétricos disponibles en la instalación de OpenSSL.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ openssl enc <span class="token parameter variable">-list</span>
aes-128-cbc               -aes-128-cfb               -aes-128-cfb1
-aes-128-cfb8              -aes-128-ctr               -aes-128-ecb
-aes-128-ofb               -aes-192-cbc               -aes-192-cfb
-aes-192-cfb1              -aes-192-cfb8              -aes-192-ctr
-aes-192-ecb               -aes-192-ofb               -aes-256-cbc
-aes-256-cfb               -aes-256-cfb1              -aes-256-cfb8
-aes-256-ctr               -aes-256-ecb               -aes-256-ofb
<span class="token parameter variable">-aes128</span>                    -aes128-wrap               -aes128-wrap-pad
<span class="token parameter variable">-aes192</span>                    -aes192-wrap               -aes192-wrap-pad
<span class="token parameter variable">-aes256</span>                    -aes256-wrap               -aes256-wrap-pad
-aria-128-cbc              -aria-128-cfb              -aria-128-cfb1
-aria-128-cfb8             -aria-128-ctr              -aria-128-ecb
-aria-128-ofb              -aria-192-cbc              -aria-192-cfb
-aria-192-cfb1             -aria-192-cfb8             -aria-192-ctr
-aria-192-ecb              -aria-192-ofb              -aria-256-cbc
-aria-256-cfb              -aria-256-cfb1             -aria-256-cfb8
-aria-256-ctr              -aria-256-ecb              -aria-256-ofb
<span class="token parameter variable">-aria128</span>                   <span class="token parameter variable">-aria192</span>                   <span class="token parameter variable">-aria256</span>
<span class="token parameter variable">-bf</span>                        -bf-cbc                    -bf-cfb
-bf-ecb                    -bf-ofb                    <span class="token parameter variable">-blowfish</span>
-camellia-128-cbc          -camellia-128-cfb          -camellia-128-cfb1
-camellia-128-cfb8         -camellia-128-ctr          -camellia-128-ecb
-camellia-128-ofb          -camellia-192-cbc          -camellia-192-cfb
-camellia-192-cfb1         -camellia-192-cfb8         -camellia-192-ctr
-camellia-192-ecb          -camellia-192-ofb          -camellia-256-cbc
-camellia-256-cfb          -camellia-256-cfb1         -camellia-256-cfb8
-camellia-256-ctr          -camellia-256-ecb          -camellia-256-ofb
<span class="token parameter variable">-camellia128</span>               <span class="token parameter variable">-camellia192</span>               <span class="token parameter variable">-camellia256</span>
<span class="token parameter variable">-cast</span>                      -cast-cbc                  -cast5-cbc
-cast5-cfb                 -cast5-ecb                 -cast5-ofb
<span class="token parameter variable">-chacha20</span>                  <span class="token parameter variable">-des</span>                       -des-cbc
-des-cfb                   -des-cfb1                  -des-cfb8
-des-ecb                   -des-ede                   -des-ede-cbc
-des-ede-cfb               -des-ede-ecb               -des-ede-ofb
-des-ede3                  -des-ede3-cbc              -des-ede3-cfb
-des-ede3-cfb1             -des-ede3-cfb8             -des-ede3-ecb
-des-ede3-ofb              -des-ofb                   <span class="token parameter variable">-des3</span>
-des3-wrap                 <span class="token parameter variable">-desx</span>                      -desx-cbc
-id-aes128-wrap            -id-aes128-wrap-pad        -id-aes192-wrap
-id-aes192-wrap-pad        -id-aes256-wrap            -id-aes256-wrap-pad
-id-smime-alg-CMS3DESwrap  <span class="token parameter variable">-idea</span>                      -idea-cbc
-idea-cfb                  -idea-ecb                  -idea-ofb
<span class="token parameter variable">-rc2</span>                       -rc2-128                   -rc2-40
-rc2-40-cbc                -rc2-64                    -rc2-64-cbc
-rc2-cbc                   -rc2-cfb                   -rc2-ecb
-rc2-ofb                   <span class="token parameter variable">-rc4</span>                       -rc4-40
<span class="token parameter variable">-seed</span>                      -seed-cbc                  -seed-cfb
-seed-ecb                  -seed-ofb                  <span class="token parameter variable">-sm4</span>
-sm4-cbc                   -sm4-cfb                   -sm4-ctr
-sm4-ecb                   -sm4-ofb
</code></pre><p>En esta lista pueden verse algunos datos importantes: <strong>algoritmos</strong> (AES, CAST, DES, BF, etc.), muchos de ellos con sus <strong>tamaños de clave</strong> asociados (128, 192, 256, etc.) y, si se trata de cifradores simétricos de <strong>bloque</strong>, el <strong>modo de operación</strong> de dichos algoritmos (ECB, CBC, CTR, OFB, CFB, etc.).</p>
<blockquote>
<p><strong>Si no se especifica un modo de operación, se utilizará el modo ECB por defecto</strong>.</p>
</blockquote>
<p>Estos algoritmos son los que debemos elegir más adelante para encriptar y, posteriormente, desencriptar un archivo.</p>
<div class="admonition info">
<p class="admonition-title">Salt &amp; Pepper</p>
<p>Cuando vamos a encriptar o desencriptar archivos usando herramientas como OpenSSL, introducimos una contraseña, o una passphrase, que solo nosotros y el destinatario del mensaje conocemos.</p>
<p>Ahora bien, los algoritmos y sus claves son de un tamaño predeterminado: 128 bits, 256 bits, etc.<br>
Si la clave que vamos a usar es de 128 bits, <strong>¿es requisito que nuestra contraseña de cifrado/descifrado tenga ese tamaño?</strong></p>
<p>La realidad es que no, nosotros ponemos contraseñas complejas o simples, y la implementación criptográfica genera, mediante una <strong>función de derivación de clave</strong>, una clave de determinado tamaño para usar en el cifrado. Por supuesto, si a la función de derivación de clave le introducimos la misma contraseña, generará la misma clave.</p>
<p>Esta función de derivación de clave, o KDF (Key Derivation Function) depende de la implementación de la aplicación criptográfica. Existen varias implementaciones, pero una de las más utilizadas es PBKDF2.</p>
<p>key = pbkdf2(PRF, Pass, Salt, Iter, Size)</p>
<blockquote>
<p>PRF: Pseudo-Random Function / Pass: Contraseña / Salt: Sal criptográfica / Iter: Iteraciones (10000) / Size: Tamaño de la clave</p>
</blockquote>
<p>Cuando se cifra con contraseña, OpenSSL pasa esta contraseña, junto con 64 bits aleatorios de <code>sal criptográfica</code>, por un algoritmo de derivación de claves como el PBKDF1 (obsoleto) o el PBKDF2 (explicado en las "opciones de enc").</p>
<p>Estos algoritmos utilizan funciones de resumen de forma recursiva para obtener suficientes bits para la clave de cifrado y para el vector de inicialización si es necesario. Esto permite que para una misma contraseña, se generen diferentes claves, al variar en cada caso la sal obtenida aleatoriamente.</p>
<p><a href="https://www.expressvpn.com/blog/salt-hash-password-protection/">Salts and hashes: How apps and websites protect your passwords</a><br>
<a href="https://en.wikipedia.org/wiki/Passwd#Shadow_file">Linux-style shadow file</a></p>
</div>
<h3 id="221-cifrado-simétrico-de-flujo">2.2.1. Cifrado simétrico de flujo </h3>
<p>Para cifrar un archivo de texto plano, utilizamos el siguiente comando:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token string">"Hola, mundo"</span> <span class="token operator">&gt;</span> mensaje.txt
$ openssl enc <span class="token parameter variable">-e</span> -aes-256-cbc <span class="token parameter variable">-salt</span> <span class="token parameter variable">-in</span> mensaje.txt <span class="token parameter variable">-out</span> mensaje.enc
enter aes-256-cbc encryption password:
Verifying - enter aes-256-cbc encryption password:

*** WARNING <span class="token builtin class-name">:</span> deprecated key derivation used.
Using <span class="token parameter variable">-iter</span> or <span class="token parameter variable">-pbkdf2</span> would be better.
</code></pre><p>En este caso, el comando <code>enc</code> cifra <strong>(-e)</strong> el archivo <code>mensaje.txt</code> <strong>(-in)</strong> utilizando el algoritmo AES con una clave de 256 bits en modo CBC <strong>(-aes-256-cbc)</strong>. El archivo cifrado se guarda en <code>mensaje.enc</code> <strong>(-out)</strong>.</p>
<p>Podemos observar el mensaje de que se está utilizando una derivación de clave obsoleta. Para evitarlo, podemos utilizar la opción <code>-pbkdf2</code> para usar la función de derivación de clave PBKDF2.</p>
<p>Para descifrar el archivo cifrado, utilizamos el siguiente comando:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ openssl enc <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> -aes-256-cbc <span class="token parameter variable">-in</span> mensaje.enc <span class="token parameter variable">-out</span> mensaje.dec
enter aes-256-cbc decryption password:
<span class="token assign-left variable">salt</span><span class="token operator">=</span>86239987878B82C6
<span class="token assign-left variable">key</span><span class="token operator">=</span>37081952A242A1720D09A0AB511DD7AE34F90AAF1EFAB9A90B76FA0C6044C95C
iv <span class="token operator">=</span>629F89ACCDE7F852B54AD9A0AA4F2B0E
</code></pre><p>En este caso, el comando <code>enc</code> descifra <strong>(-d)</strong> el archivo <code>mensaje.enc</code> <strong>(-in)</strong> utilizando el algoritmo AES con una clave de 256 bits en modo CBC <strong>(-aes-256-cbc)</strong>. El archivo descifrado se guarda en <code>mensaje.dec</code> <strong>(-out)</strong>. Además, hemos usado el modificador <code>-p</code> para que se muestre información adicional (Salt, Key, IV) sobre el proceso de cifrado/descifrado.</p>
<p>El archivo <code>mensaje.enc</code> es un archivo binario que contiene el texto cifrado. Si intentamos abrirlo con un editor de texto, o con el comando <code>type</code> (windows) o <code>cat</code> (Linux) veremos caracteres extraños.</p>
<p>Si queremos generar un archivo cifrado, pero que solo contenga caracteres ASCII, podemos utilizar la opción <code>-a</code> para que el archivo cifrado sea codificado en base64.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>$ openssl enc <span class="token parameter variable">-e</span> -aes-256-cbc <span class="token parameter variable">-pbkdf2</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-in</span> mensaje.txt 
enter aes-256-cbc encryption password:
Verifying - enter aes-256-cbc encryption password:

U2FsdGVkX1/bxhJnZxZH39gxnhOd7/QyB2yDcexnLE2nnlJ1+EZH3ka3z2oHOvMR
TQk6dQ7CwLJ7tLIFeUId1jbvYVxgMTGE99kJHikaD4x8Kf8Jw3/LsQmRPLRHnUiZ
</code></pre><p>En el ejemplo anterior ya se ha usado la opción <code>-kbkdf2</code> para evitar el mensaje de advertencia y suar un algoritmo de derivación de clave más seguro. También se ha usado la opción <code>-a</code> para que el archivo cifrado sea codificado en base64 y se ha omitido la opción <code>-out</code> para que el resultado se muestre por pantalla.</p>
<h4 id="triple-des">TRIPLE DES </h4>
<p>DES es el algoritmo prototipo del cifrado por bloques. Su clave es de 56 bits, lo que lo hace vulnerable a ataques de fuerza bruta. Para aumentar la seguridad, se creó <strong>3DES</strong>, que aplica DES tres veces a cada bloque de datos. Aunque es más seguro, es más lento que DES.</p>
<p>La mayoría de las tarjetas de crédito y otros medios de pago electrónicos tienen como estándar el algoritmo <strong>Triple DES</strong> (anteriormente usaban el DES). Por su diseño, el DES y por lo tanto el 3DES son algoritmos lentos. AES puede llegar a ser hasta 6 veces más rápido y a la fecha no se ha encontrado ninguna vulnerabilidad</p>
<p>Existen diferentes tipos de TDES, aunque el más utilizado es el EDE3 (Encrypt-Decrypt-Encrypt) con dos claves DES diferentes. En el siguiente ejemplo se cifra un archivo con 3DES:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>openssl enc -des-ede3-cbc <span class="token parameter variable">-p</span> <span class="token parameter variable">-in</span> mensaje.txt <span class="token parameter variable">-out</span> des_ede3_cbc.enc

<span class="token assign-left variable">salt</span><span class="token operator">=</span>AB5835474350C692
<span class="token assign-left variable">key</span><span class="token operator">=</span>D9A1F0F149CB70901A2411C5607BEA89C9DFF9786B018DF7B2158967D42B0D4D
iv <span class="token operator">=</span>4AE3E7B85BE8AE5C752187CFC0CC9672
</code></pre><p>Y a continuación se descifra:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>openssl enc <span class="token parameter variable">-d</span> -des-ede3-cbc <span class="token parameter variable">-p</span> <span class="token parameter variable">-in</span> des_ede3_cbc.enc

<span class="token assign-left variable">salt</span><span class="token operator">=</span>AB5835474350C692
<span class="token assign-left variable">key</span><span class="token operator">=</span>D9A1F0F149CB70901A2411C5607BEA89C9DFF9786B018DF7B2158967D42B0D4D
iv <span class="token operator">=</span>4AE3E7B85BE8AE5C752187CFC0CC9672
<span class="token string">"Hola, mundo"</span>
</code></pre><div class="admonition note">
<p class="admonition-title">Note</p>
<p>También podemos descifrar el mensaje sin conocer la contraseña, si conocemos el resto de los parámetros (salt, key, iv). Esto es útil para recuperar mensajes cifrados en caso de pérdida de la contraseña.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>openssl enc <span class="token parameter variable">-d</span> -des-ede3-cbc <span class="token parameter variable">-in</span> des_ede3_cbc.enc <span class="token parameter variable">-K</span> D9A1F0F149CB70901A2411C5607BEA89C9DFF9786B018DF7B2158967D42B0D4D <span class="token parameter variable">-iv</span> 4AE3E7B85BE8AE5C752187CFC0CC9672
ÃhÁs<span class="token punctuation">{</span>N╣µ·¦mtæ┬óh═åÅundo"
</code></pre><p>Como vemos, el SALT que se ha añadido al mensaje cifrado, ha modificado el mensaje original. Assí que, para recuperar el mensaje original, necesitamos eliminar el SALT del mensaje cifrado.</p>
<ul>
<li>Editamos el archivo cifrado (es binario) en modo hexadecimal y eliminamos de la cabecera los primeros 8 bytes ("Salted__") y los siguientes 8 bytes (el valor del SALT).</li>
<li>En linux lo podemos hacer con <code>dd</code>:<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token function">cat</span> des_ede3_cbc.cif <span class="token operator">|</span> <span class="token function">dd</span> <span class="token assign-left variable">ibs</span><span class="token operator">=</span><span class="token number">16</span> <span class="token assign-left variable">obs</span><span class="token operator">=</span><span class="token number">16</span> <span class="token assign-left variable">skip</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">&gt;</span> des_ede3_cbc_nosalt.enc
</code></pre></li>
</ul>
<p><img src="recursos/EncodedFileWithSalt.png" alt="Salt"></p>
<p>Una vez eliminado el SALT, procedemos a descifrar el archivo usando la clave y el vector de inicialización.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>openssl enc <span class="token parameter variable">-d</span> -des-ede3-cbc <span class="token parameter variable">-in</span> des_ede3_cbc_nosalt.enc <span class="token parameter variable">-K</span> D9A1F0F149CB70901A2411C5607BEA89C9DFF9786B018DF7B2158967D42B0D4D <span class="token parameter variable">-iv</span> 4AE3E7B85BE8AE5C752187CFC0CC9672
<span class="token string">"Hola, mundo"</span>
</code></pre></div>
<h4 id="aes-advanced-encryption-standard">AES (Advanced Encryption Standard) </h4>
<p>AES, también conocido como Rijndael (pronunciado "Rain Doll" en inglés), es un esquema de cifrado por bloques adoptado como un estándar de cifrado por el gobierno de los Estados Unidos. Desde 2006, el AES es uno de los algoritmos más populares usados en criptografía simétrica.</p>
<div class="admonition info">
<p class="admonition-title">Daemen &amp; Rijmen</p>
<p>El cifrado fue desarrollado por dos criptólogos belgas, Joan Daemen y Vincent Rijmen, ambos estudiantes de la Katholieke Universiteit Leuven, y fue enviado al proceso de selección AES bajo el nombre "Rijndael".</p>
<p>Fueron los ganares del concurso AES, y el algoritmo fue seleccionado como el estándar de cifrado simétrico por el Instituto Nacional de Estándares y Tecnología (NIST) en 2001.</p>
<p>Se trata de un algoritmo del que <strong>todavía no se ha registrado ningún ataque factible hacia él</strong>, convirtiéndose en un estándar de cifrado para las principales organizaciones como bancos, gobiernos y sistemas de alta seguridad en todo el mundo. Además, es un estándar mucho más rápido que los vistos anteriormente.</p>
</div>
<p>Basado en la estructura de bloques de AES, el cambio de un solo bit, ya sea en la clave, o en el bloque de texto sin cifrado, da como resultado un bloque de texto cifrado completamente diferente. Este algoritmo tiene una <strong>longitud de bloque de 128 bits y longitudes de clave de 128, 192 y 256</strong>.</p>
<p>En el primer ejemplo del apartado anterior, hemos cifrado un archivo de texto plano con AES y una clave de 256 bits en modo CBC.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code></code></pre>
      </div>
      
      
    
    
    
    
    
    
  
    </body></html>